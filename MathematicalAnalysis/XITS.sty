%% Begin of file `XITS.sty'.
%% ----------------------------------------------------------------------------

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{XITS}
  [2011/11/21 v1.0 XITS as default roman family]

\RequirePackage{kvoptions}

\DeclareVoidOption{math}{%
  \RequirePackage{unicode-math}%
  \setmathfont{XITS Math}%
}

\@ifpackageloaded{fontspec}{}{%
  \DeclareDefaultOption{%
    \PassOptionsToPackage{\CurrentOption}{fontspec}}%
  \RequirePackage{fontspec}}

\def\XITS@scale@to@rm#1#2{%
  \begingroup
  \fontsize{10}{0}\usefont{\encodingdefault}{\rmdefault}{m}{n}%
  #1%
  \xdef\XITS@scale{%
    \strip@pt
    \dimexpr  1pt *
    \@tempdima / \dimexpr#2pt\relax
    \relax}%
  \PackageInfo{XITS}{The xitstm family is scaled by \XITS@scale}
  \endgroup
}

\SetupKeyvalOptions{prefix=XITS@}
\DeclareStringOption{scale}[1]

\define@key{XITS}{matchlowercase}[1]{%
  \XITS@scale@to@rm{\@tempdima#1\fontdimen5\font}{4.49998}}
\define@key{XITS}{matchuppercase}[1]{%
  \XITS@scale@to@rm{\setbox0\hbox{XWYZH}\@tempdima#1\ht0}{6.76}}
\DeclareVoidOption{oldspacing}{%
  \def\XITS@set@spacing{%
    \fontdimen2\font=.333em
    \fontdimen3\font=.222em
    \fontdimen4\font=.111em
  }%
}

\ProcessKeyvalOptions*

\renewcommand{\rmdefault}{xitstm}
\fontfamily{\familydefault}
\renewcommand\bfdefault{b}

\endinput
%%
%% End of file `XITS.sty'.
